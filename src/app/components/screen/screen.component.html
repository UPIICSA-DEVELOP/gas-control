<!--
  ~ Copyright (C) MapLander S de R.L de C.V - All Rights Reserved
  ~  Unauthorized copying of this file, via any medium is strictly prohibited
  ~  Proprietary and confidential
  -->

<router-outlet></router-outlet>
<!-- Nav Bar [STAR]-->
<app-nav-bar></app-nav-bar>
<!-- Nav Bar [END]-->

<div id="home">
  <div class="background" *ngIf="!stationActive"></div>
  <div *ngIf="!stationActive; then emptyDash else dashboard"></div>
  <ng-template #emptyDash>
    <div class="empty" *ngIf="!load">
      <div class="text" *ngIf="role && (role <= 3 || role === 7)">Aún no existen Estaciones de Servicio a cargo de la Consultora</div>
      <button mat-button class="button" (click)="addStation()" *ngIf="role && (role <= 3 || role === 7)">
        <mat-icon>add</mat-icon>
        <span>AGREGAR ESTACIÓN</span>
      </button>
    </div>
  </ng-template>
  <ng-template #dashboard>
    <mat-drawer-container>
      <mat-drawer class="menu" mode="side" [opened]="true" [disableClose]="true">
        <div class="station-information" *ngIf="stationActive">
          <div style="margin-top: -48px">
            <div class="image">
              <div class="container">
                <img *ngIf="utils" [src]="utils.groupIcons[stationActive.type-1].fileCS.thumbnail">
                <mat-icon *ngIf="!utils">local_gas_station</mat-icon>
              </div>
            </div>
            <div class="contact">
              <div class="info">{{stationActive.phoneNumber}}</div>
              <div class="info">{{stationActive.email}}</div>
            </div>
            <mat-divider></mat-divider>
            <div class="buttons">
              <button [color]="'primary'"  mat-button [routerLink]="'/home/profile/gas-station'" [queryParams]="{id: stationActive.id}">
                <mat-icon>local_gas_station</mat-icon>
                <span>Información de Estación</span>
              </button>
              <button [color]="'primary'"  mat-button (click)="addCollaborator()" *ngIf="role!==6">
                <mat-icon>person_add</mat-icon>
                <span>Añadir Colaborador de Estación</span>
              </button>
              <button [color]="'primary'"  mat-button (click)="openNotifications()">
                <mat-icon>notifications</mat-icon>
                <span>Notificaciones</span>
              </button>
              <button [color]="'primary'" mat-button routerLink="/home/procedures">
                <mat-icon>library_books</mat-icon>
                <span>Procedimientos</span>
              </button>
              <button mat-button [disabled]="!stationActive.stationTaskId" (click)="openSasisopaModal()" *ngIf="role!==6">
                <img *ngIf="stationActive.stationTaskId" class="sass-icon" src="../../../assets/image/ssp_blue.png">
                <img *ngIf="!stationActive.stationTaskId" style="margin-right: 8px" src="../../../assets/image/ssp_disabled.png">
                <span>SASISOPA</span>
              </button>
              <button mat-button [disabled]="!stationActive.stationTaskId" (click)="openSGMModal()" *ngIf="role!==6">
                <img *ngIf="stationActive.stationTaskId" class="sgm" src="../../../assets/image/sgm.png">
                <img *ngIf="!stationActive.stationTaskId" class="sgm" src="../../../assets/image/sgm_disabled.png">
                <span>Sistema de Gestión de Mediciones</span>
              </button>
              <button [color]="'primary'" mat-button [disabled]="!stationActive.stationTaskId" (click)="openOtherTasks()">
                <mat-icon>more_vert</mat-icon>
                <span>Otros</span>
              </button>
            </div>
          </div>
          <div class="change-station" *ngIf="role<=4">
            <button mat-button routerLink="/home/station-list">
              <mat-icon>compare_arrows</mat-icon>
              <span>Cambiar Estación de Servicio</span>
            </button>
          </div>
        </div>
      </mat-drawer>
      <mat-drawer-content class="main">
        <div class="col-1">
          <div class="title" *ngIf="stationActive && utils">
            <h1>{{utils.groupIcons[stationActive.type-1].name}} - {{stationActive.name}}</h1>
            <h2>{{stationActive.managerName}}</h2>
            <p>{{stationActive.doneTasks}}/{{stationActive.totalTasks}} actividades</p>
          </div>
          <div class="tasks">
            <app-list-tasks [utils]="utils" [stationInfo]="stationActive"></app-list-tasks>
          </div>
        </div>
        <div class="col-2">
          <div class="progress">
            <app-station-status [station]="stationActive"></app-station-status>
          </div>
          <div class="directory">
            <app-directory-list [gasStation]="stationActive" [utils]="utils"></app-directory-list>
          </div>
          <div class="footer">
            <app-footer></app-footer>
          </div>
        </div>
      </mat-drawer-content>
    </mat-drawer-container>
  </ng-template>

</div>

