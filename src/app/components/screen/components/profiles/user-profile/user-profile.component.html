<!--
  ~ Copyright (C) MapLander S de R.L de C.V - All Rights Reserved
  ~ Unauthorized copying of this file, via any medium is strictly prohibited
  ~ Proprietary and confidential
  -->

<div id="user-profile">
  <div class="background"></div>
  <form *ngIf="user else loading" [formGroup]="profileForm" class="container">
    <div class="information">
      <mat-card class="content">
        <div class="head">
          <div class="image">
            <app-upload-image [layoutTemplate]="icon" (onLoadImage)="onLoadImage($event)" (onRemoveImage)="onRemoveImage()">
              <ng-template #icon>
                <img *ngIf="profileImage" [src]="profileImage" class="profileImage" alt="User profile image">
                <mat-icon *ngIf="!profileImage" class="defaultProfileImage">account_circle</mat-icon>
              </ng-template>
            </app-upload-image>
          </div>
          <span class="title">Mi información</span>
        </div>
        <mat-card-content class="user-form">
          <div>
            <mat-form-field class="inputs">
              <input [attr.disabled]="load?true:null" formControlName="name" matInput placeholder="Nombre(s)" required type="text" aria-label="User name">
              <mat-error *ngIf="profileForm.controls['name'].hasError('required')">
                Este campo es obligatorio
              </mat-error>
            </mat-form-field>
            <mat-form-field class="inputs">
              <input [attr.disabled]="load?true:null" formControlName="lastName" matInput placeholder="Apellido(s)" required type="text" aria-label="User last-name">
              <mat-error *ngIf="profileForm.controls['lastName'].hasError('required')">
                Este campo es obligatorio
              </mat-error>
            </mat-form-field>
            <mat-form-field class="inputs">
              <input formControlName="email" matInput placeholder="Email comercial" type="email" aria-label="User email">
              <mat-error *ngIf="profileForm.controls['email'].hasError('required')">
                Este campo es obligatorio
              </mat-error>
            </mat-form-field>

            <div class="country-code">
              <div class="mask" (click)="openListCountry()"></div>
              <mat-form-field class="inputs">
                <input [attr.disabled]="load?true:null" formControlName="country" matInput placeholder="País" type="text" required aria-label="User country">
                <mat-error *ngIf="profileForm.controls['country'].hasError('required')">
                  Este campo es obligatorio
                </mat-error>
              </mat-form-field>
            </div>
            <div style="display: flex">
              <mat-form-field class="right-inputs">
                <input [attr.disabled]="load?true:null" formControlName="code" matInput placeholder="Código" type="text" aria-label="Phone code">
              </mat-form-field>
              <mat-form-field class="inputs">
                <input [attr.disabled]="load?true:null" formControlName="phoneNumber" matInput placeholder="Número celular" required type="tel" aria-label="User cellphone number">
                <mat-error *ngIf="profileForm.controls['phoneNumber'].hasError('required')">
                  Este campo es obligatorio
                </mat-error>
                <mat-error *ngIf="profileForm.controls['phoneNumber'].hasError('minlength')">
                  Se requieren de 8 a 13 dígitos
                </mat-error>
                <mat-error *ngIf="profileForm.controls['phoneNumber'].hasError('maxlength')">
                  Se requieren de 8 a 13 dígitos
                </mat-error>
              </mat-form-field>
            </div>
            <mat-form-field class="inputs">
              <input disabled placeholder="Rol" required aria-label="User role" [value]="userRole" matInput>
            </mat-form-field>
            <mat-form-field class="inputs">
              <input [attr.disabled]="load?true:null" formControlName="jobTitle" matInput placeholder="Cargo" required type="text" aria-label="User job-title">
              <mat-error *ngIf="profileForm.controls['jobTitle'].hasError('required')">
                Este campo es obligatorio
              </mat-error>
            </mat-form-field>
            <div class="country-code">
              <div class="mask" (click)="changePassword()"></div>
              <mat-form-field class="inputs">
                <input [attr.disabled]="load?true:null" formControlName="password" matInput placeholder="Actualizar Contraseña" type="password" aria-label="User password">
              </mat-form-field>
            </div>
            <div style="display: flex">
              <mat-form-field class="right-inputs">
                <mat-select [disabled]="load" placeholder="Protocolo" aria-label="User website protocol" [(value)]="protocol">
                  <mat-option value="http://">http://</mat-option>
                  <mat-option value="https://">https://</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field class="inputs">
                <input [attr.disabled]="load?true:null" placeholder="Website" formControlName="website" matInput type="url" aria-label="User website">
                <mat-error *ngIf="profileForm.controls['website'].hasError('pattern')">
                  Ingrese un sitio web válido
                </mat-error>
              </mat-form-field>
            </div>
            <div class="signature-input">
              <div class="formHead">Firma digital</div>
              <div class="signatureContainer">
                <div class="signature">
                  <span *ngIf="!user.signature" class="formText">Registre firma digital</span>
                  <img *ngIf="user.signature" [src]="user.signature.thumbnail" class="imageSignature" alt="User signature image">
                </div>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="information-extra">
      <div>
        <mat-card class="content">
          <mat-card-content>
            <span class="title">Información adicional</span>
            <div>
              <mat-form-field class="inputs">
                <input matInput placeholder="Número de seguridad social" type="text" aria-label="User social security ID">
              </mat-form-field>
              <mat-form-field class="inputs">
                <input matInput placeholder="Tipo de sangre" type="text" aria-label="User blood type">
              </mat-form-field>
              <mat-form-field class="inputs">
                <input matInput placeholder="Estudio de Toxicidad (Benceno)" aria-label="User healty study">
              </mat-form-field>
              <div style="padding: 0 8px">
                <div class="formHead">Contacto de emergencias</div>
                <div style="padding: 0 8px">
                  <mat-form-field class="inputs">
                    <input matInput placeholder="Nombre" type="text" aria-label="User emergency contact name">
                  </mat-form-field>
                  <mat-form-field class="inputs">
                    <input matInput placeholder="Número celular" type="tel" aria-label="User emergency contact phone number">
                  </mat-form-field>
                  <mat-form-field class="inputs">
                    <input matInput placeholder="Parentesco" type="text" aria-label="User emergency contact relationship">
                  </mat-form-field>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
        <div class="form-button">
          <button mat-flat-button aria-label="LogIn" [disabled]="load" [color]="'primary'" mat-button>GUARDAR CAMBIOS</button>
        </div>
      </div>
    </div>
    <div class="business-card">

    </div>
  </form>
  <ng-template #loading>
    <mat-spinner></mat-spinner>
  </ng-template>
  <div class="btn-close">
    <button mat-icon-button matTooltip="Cerrar" aria-label="Close-button" (click)="closeProfile()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</div>
