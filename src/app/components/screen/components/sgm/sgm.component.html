<!--
  ~  Copyright (C) MapLander S de R.L de C.V - All Rights Reserved
  ~  Unauthorized copying of this file, via any medium is strictly prohibited
  ~  Proprietary and confidential
  -->

<div id="sgm">
  <mat-dialog-content>
    <mat-progress-bar [mode]="'indeterminate'" *ngIf="load" class="progress"></mat-progress-bar>
    <div class="close">
      <button mat-icon-button (click)="close()">
        <mat-icon *ngIf="elementOnView !== 0">arrow_back</mat-icon>
        <mat-icon *ngIf="elementOnView === 0">close</mat-icon>
      </button>
    </div>
    <div class="header">
      <img class="sgm-logo" src="../../../../assets/image/sgm_gray.png">
      <div class="text">Sistema de Gestión de Mediciones</div>
    </div>
    <ng-container [ngSwitch]="elementOnView">
      <div *ngSwitchCase="0" style="display: flex; margin: 12px 0;">
        <div class="columns">
          <div *ngIf="generate; then buttonsSGM else card"></div>
          <ng-template #card>
            <mat-card (click)="generateSgm()" style="width: 100%;margin: 8px 0;cursor: pointer;">
              <mat-card-content style="display: flex; align-items: center">
                <mat-icon class="gray">insert_drive_file</mat-icon>
                <div class="divider">GENERAR</div>
              </mat-card-content>
            </mat-card>
          </ng-template>
          <ng-template #buttonsSGM>
            <div class="fuel-type">
              <button style="height: 36px" mat-flat-button (click)="generateSgm()" [color]="'primary'">GENERAR</button>
              <button style="height: 36px" mat-flat-button [color]="'primary'" [disabled]="!isAvailable" (click)="seeSGM()">VER</button>
            </div>
          </ng-template>
          <div class="date-available" *ngIf="generate && !isAvailable && dateGeneration.length !== 0">Documento disponible hasta el {{dateGeneration[0]}} {{dateGeneration[1]}} {{dateGeneration[2]}}</div>
          <mat-card (click)="seeFile(templates[3].fileCS.thumbnail)" class="list-and-template">
            <mat-card-content>
              <mat-icon class="gray">insert_drive_file</mat-icon>
              <div class="divider">VER PLANTILLA</div>
            </mat-card-content>
          </mat-card>
          <mat-card (click)="getStationTasks(true)" class="list-and-template">
            <mat-card-content>
              <mat-icon class="gray">insert_drive_file</mat-icon>
              <div class="divider">Anexo 1</div>
            </mat-card-content>
          </mat-card>
          <mat-card (click)="getStationTasks(false)" class="list-and-template">
            <mat-card-content>
              <mat-icon class="gray">insert_drive_file</mat-icon>
              <div class="divider">Anexo 2</div>
            </mat-card-content>
          </mat-card>
          <div class="divide"></div>
          <div *ngIf="station" class="software-type">
            <div>6.2.2 Software</div> <br> {{station.name}} mantiene el control de los datos de medición de volumen mediante el siguiente software:
          </div>
          <div class="fuel-type-text">Consulte la hoja de seguridad correspondiente a su tipo de combustible</div>
          <div class="fuel-type">
            <mat-checkbox [(ngModel)]="magna"></mat-checkbox>
            <mat-card (click)="seeFile(templates[0].fileCS.thumbnail)" class="fuel">
              <mat-card-content>
                <mat-icon class="gray">insert_drive_file</mat-icon>
                <div class="divider">Magna</div>
              </mat-card-content>
            </mat-card>
          </div>
          <div class="fuel-type">
            <mat-checkbox [(ngModel)]="premium"></mat-checkbox>
            <mat-card (click)="seeFile(templates[1].fileCS.thumbnail)" class="fuel">
              <mat-card-content>
                <mat-icon class="gray">insert_drive_file</mat-icon>
                <div class="divider">Premium</div>
              </mat-card-content>
            </mat-card>
          </div>
          <div class="fuel-type">
            <mat-checkbox [(ngModel)]="diesel"></mat-checkbox>
            <mat-card (click)="seeFile(templates[2].fileCS.thumbnail)" class="fuel">
              <mat-card-content>
                <mat-icon class="gray">insert_drive_file</mat-icon>
                <div class="divider">Diesel</div>
              </mat-card-content>
            </mat-card>
          </div>
          <div class="save">
            <button mat-flat-button (click)="saveSgmSelection()" [color]="'primary'">GUARDAR CAMBIOS</button>
          </div>
        </div>
        <div class="columns">
          <div *ngIf="station" class="software-type">
            <div>6.2.3 Registros</div> <br> {{station.name}} mantiene el registro de las mediciones del volumen en tanques de almacenamiento utilizando el software:
          </div>
          <div *ngIf="station" class="software-type">
            <div>6.3.1 Equipos de medición</div> <br> {{station.name}} cuenta con los siguentes equipos en su sistema de medición:
          </div>
          <div class="fuel-type-text">
            Defina el software y el equipo de telemedición que utiliza
          </div>
          <mat-radio-group [(ngModel)]="software">
            <div style="display: flex; justify-content: space-around; align-items: center;" *ngFor="let item of sgmDocument; let i = index">
              <mat-radio-button [value]="i+1"></mat-radio-button>
              <mat-card (click)="seeFile(item.fileCS.thumbnail)" style="cursor: pointer; margin: 8px 0; width: 85%;">
                <mat-card-content style="display: flex; align-items: center">
                  <mat-icon class="gray">insert_drive_file</mat-icon>
                  <div class="divider">{{item.name}}</div>
                </mat-card-content>
              </mat-card>
            </div>
          </mat-radio-group>
        </div>
      </div>
      <div style="width: 75%; margin: 0 auto;" *ngSwitchCase="1">
        <div style="margin: 8px 0; width: 100%; text-align: center">Evidencia de la Prueba de funcionamiento de sensores (motobomba, espacio anular y pozos de observacion)</div>
        <div *ngIf="listTasks.length !== 0; then completeList else emptyListTasks"></div>
        <ng-template #completeList>
          <div *ngFor="let task of listTasks">
            <mat-card class="task">
              <div class="priority" *ngIf="task.origin.level === 3" style="background-color:#E00000"></div>
              <div class="priority" *ngIf="task.origin.level === 1" style="background-color:#257602"></div>
              <div class="priority" *ngIf="task.origin.level === 2" style="background-color:#FFD800"></div>
              <mat-card-content>
                <div class="date">
                  <div>
                    <div class="text-bold">{{task.date[0]}}</div>
                    <div class="text-bold">{{task.date[1]}}</div>
                  </div>
                </div>
                <div class="content">
                  <div class="head">{{task.origin.name}}</div>
                  <div class="text">{{zones[task.origin.zone-1]}}</div>
                  <div class="text">{{priority[task.origin.level-1]}}</div>
                </div>
                <div style="position: absolute; bottom: 0; right: 0; margin: 16px;">
                  <div>{{frequency[task.origin.frequency-1]}}</div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </ng-template>
        <ng-template #emptyListTasks>
          <div style="display:flex; justify-content: center; align-items: center; margin-top: 16px;">
            <div class="gray">No hay registro de este tipo de tareas aún</div>
          </div>
        </ng-template>
      </div>
      <div style="width: 75%; margin: 0 auto;" *ngSwitchCase="2">
        <div style="margin: 8px 0; width: 100%; text-align: center">Evidencia de funcionamiento de sensores de dispensario</div>
        <div *ngIf="listTasks.length !== 0; then completeList else emptyListTasks"></div>
        <ng-template #completeList>
          <div *ngFor="let task of listTasks">
            <mat-card class="task">
              <div class="priority" *ngIf="task.origin.level === 3" style="background-color:#E00000"></div>
              <div class="priority" *ngIf="task.origin.level === 1" style="background-color:#257602"></div>
              <div class="priority" *ngIf="task.origin.level === 2" style="background-color:#FFD800"></div>
              <mat-card-content>
                <div class="date">
                  <div>
                    <div class="text-bold">{{task.date[0]}}</div>
                    <div class="text-bold">{{task.date[1]}}</div>
                  </div>
                </div>
                <div class="content">
                  <div class="head">{{task.origin.name}}</div>
                  <div class="text">{{zones[task.origin.zone-1]}}</div>
                  <div class="text">{{priority[task.origin.level-1]}}</div>
                </div>
                <div style="position: absolute; bottom: 0; right: 0; margin: 16px;">
                  <div>{{frequency[task.origin.frequency-1]}}</div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </ng-template>
        <ng-template #emptyListTasks>
          <div style="display:flex; justify-content: center; align-items: center; margin-top: 16px;">
            <div class="gray">No hay registro de este tipo de tareas aún</div>
          </div>
        </ng-template>
      </div>
    </ng-container>

  </mat-dialog-content>
</div>
